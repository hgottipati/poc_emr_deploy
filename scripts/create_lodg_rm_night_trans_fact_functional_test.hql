DROP TABLE IF EXISTS commerce.lodg_rm_night_trans_fact_functional_test;

CREATE EXTERNAL TABLE `commerce.lodg_rm_night_trans_fact_functional_test`(
  `bkg_itm_id` int,
  `trans_date_key` date,
  `trans_typ_key` smallint,
  `use_date_key` date,
  `cost_currn_key` smallint,
  `src_sys_id` int,
  `bkg_id` int,
  `begin_use_date_key` date,
  `bk_date_key` date,
  `bk_datetm` string,
  `bk_trvl_acct_key` int,
  `bkg_ind_key` int,
  `bkg_lang_key` smallint,
  `bkg_product_ln_component_key` int,
  `bkg_windw_key` int,
  `business_partnr_key` int,
  `end_use_date_key` date,
  `grp_acct_key` int,
  `hist_lodg_property_key` int,
  `lodg_property_key` int,
  `lodg_rate_pln_key` int,
  `lodg_rate_rule_key` int,
  `oper_unit_key` smallint,
  `price_currn_key` smallint,
  `product_ln_key` smallint,
  `purch_trvl_acct_key` int,
  `tpid_currn_key` smallint,
  `trans_datetm` string,
  `ab_tst_grp_id` int,
  `tpid` int,
  `trl` int,
  `adult_cnt` smallint,
  `child_cnt` smallint,
  `infant_cnt` smallint,
  `totl_persn_cnt` smallint,
  `rm_night_cnt` smallint,
  `gross_bkg_amt_usd` double,
  `gross_bkg_amt_local` double,
  `gross_bkg_amt_tpid` double,
  `gross_purch_price_amt_usd` double,
  `gross_purch_price_amt_local` double,
  `gross_purch_price_amt_tpid` double,
  `gross_purch_cost_amt_usd` double,
  `gross_purch_cost_amt_local` double,
  `gross_purch_cost_amt_tpid` double,
  `gross_cncl_price_amt_usd` double,
  `gross_cncl_price_amt_local` double,
  `gross_cncl_price_amt_tpid` double,
  `gross_cncl_cost_amt_usd` double,
  `gross_cncl_cost_amt_local` double,
  `gross_cncl_cost_amt_tpid` double,
  `base_price_amt_usd` double,
  `base_price_amt_local` double,
  `base_price_amt_tpid` double,
  `base_cost_amt_usd` double,
  `base_cost_amt_local` double,
  `base_cost_amt_tpid` double,
  `agnt_asst_purch_fee_amt_usd` double,
  `agnt_asst_purch_fee_amt_local` double,
  `agnt_asst_purch_fee_amt_tpid` double,
  `cncl_chg_fee_price_amt_usd` double,
  `cncl_chg_fee_price_amt_local` double,
  `cncl_chg_fee_price_amt_tpid` double,
  `coupn_price_amt_usd` double,
  `coupn_price_amt_local` double,
  `coupn_price_amt_tpid` double,
  `dyn_rate_rule_price_amt_usd` double,
  `dyn_rate_rule_price_amt_local` double,
  `dyn_rate_rule_price_amt_tpid` double,
  `dyn_rate_rule_cost_amt_usd` double,
  `dyn_rate_rule_cost_amt_local` double,
  `dyn_rate_rule_cost_amt_tpid` double,
  `genric_coupn_price_amt_usd` double,
  `genric_coupn_price_amt_local` double,
  `genric_coupn_price_amt_tpid` double,
  `gdwll_price_adj_amt_usd` double,
  `gdwll_price_adj_amt_local` double,
  `gdwll_price_adj_amt_tpid` double,
  `expe_gdwll_price_adj_amt_usd` double,
  `expe_gdwll_price_adj_amt_local` double,
  `expe_gdwll_price_adj_amt_tpid` double,
  `expe_pnlty_price_adj_amt_usd` double,
  `expe_pnlty_price_adj_amt_local` double,
  `expe_pnlty_price_adj_amt_tpid` double,
  `extra_persn_price_amt_usd` double,
  `extra_persn_price_amt_local` double,
  `extra_persn_price_amt_tpid` double,
  `extra_persn_cost_amt_usd` double,
  `extra_persn_cost_amt_local` double,
  `extra_persn_cost_amt_tpid` double,
  `margn_amt_usd` double,
  `margn_amt_tpid` double,
  `othr_price_adj_amt_usd` double,
  `othr_price_adj_amt_local` double,
  `othr_price_adj_amt_tpid` double,
  `othr_cost_adj_amt_usd` double,
  `othr_cost_adj_amt_local` double,
  `othr_cost_adj_amt_tpid` double,
  `othr_fee_price_amt_usd` double,
  `othr_fee_price_amt_local` double,
  `othr_fee_price_amt_tpid` double,
  `othr_fee_cost_amt_usd` double,
  `othr_fee_cost_amt_local` double,
  `othr_fee_cost_amt_tpid` double,
  `pkg_save_price_amt_usd` double,
  `pkg_save_price_amt_local` double,
  `pkg_save_price_amt_tpid` double,
  `pnlty_price_adj_amt_usd` double,
  `pnlty_price_adj_amt_local` double,
  `pnlty_price_adj_amt_tpid` double,
  `pure_margn_amt_usd` double,
  `pure_margn_amt_tpid` double,
  `rate_pln_restr_price_amt_usd` double,
  `rate_pln_restr_price_amt_local` double,
  `rate_pln_restr_price_amt_tpid` double,
  `rate_pln_restr_cost_amt_usd` double,
  `rate_pln_restr_cost_amt_local` double,
  `rate_pln_restr_cost_amt_tpid` double,
  `rebate_price_amt_usd` double,
  `rebate_price_amt_local` double,
  `rebate_price_amt_tpid` double,
  `refund_price_adj_amt_usd` double,
  `refund_price_adj_amt_local` double,
  `refund_price_adj_amt_tpid` double,
  `svc_chrg_price_amt_usd` double,
  `svc_chrg_price_amt_local` double,
  `svc_chrg_price_amt_tpid` double,
  `svc_chrg_cost_amt_usd` double,
  `svc_chrg_cost_amt_local` double,
  `svc_chrg_cost_amt_tpid` double,
  `svc_fee_price_amt_usd` double,
  `svc_fee_price_amt_local` double,
  `svc_fee_price_amt_tpid` double,
  `sngl_supplmnt_price_amt_usd` double,
  `sngl_supplmnt_price_amt_local` double,
  `sngl_supplmnt_price_amt_tpid` double,
  `sngl_supplmnt_cost_amt_usd` double,
  `sngl_supplmnt_cost_amt_local` double,
  `sngl_supplmnt_cost_amt_tpid` double,
  `suppl_cost_adj_amt_usd` double,
  `suppl_cost_adj_amt_local` double,
  `suppl_cost_adj_amt_tpid` double,
  `tcm_price_adj_amt_usd` double,
  `tcm_price_adj_amt_local` double,
  `tcm_price_adj_amt_tpid` double,
  `totl_price_adj_amt_usd` double,
  `totl_price_adj_amt_local` double,
  `totl_price_adj_amt_tpid` double,
  `totl_cost_adj_amt_usd` double,
  `totl_cost_adj_amt_local` double,
  `totl_cost_adj_amt_tpid` double,
  `totl_cost_amt_usd` double,
  `totl_cost_amt_local` double,
  `totl_cost_amt_tpid` double,
  `totl_fee_price_amt_usd` double,
  `totl_fee_price_amt_local` double,
  `totl_fee_price_amt_tpid` double,
  `totl_fee_cost_amt_usd` double,
  `totl_fee_cost_amt_local` double,
  `totl_fee_cost_amt_tpid` double,
  `totl_tax_price_amt_usd` double,
  `totl_tax_price_amt_local` double,
  `totl_tax_price_amt_tpid` double,
  `totl_tax_cost_amt_usd` double,
  `totl_tax_cost_amt_local` double,
  `totl_tax_cost_amt_tpid` double,
  `var_margn_cost_adj_usd` double,
  `var_margn_cost_adj_local` double,
  `var_margn_cost_adj_tpid` double,
  `etl_load_tag` int,
  `hist_business_partnr_key` int,
  `net_svc_fee_price_amt_usd` double,
  `net_svc_fee_price_amt_local` double,
  `net_svc_fee_price_amt_tpid` double,
  `trans_trvl_acct_key` int,
  `coupn_key` int,
  `cncl_pnlty_waivr_price_adj_amt_usd` double,
  `cncl_pnlty_waivr_price_adj_amt_local` double,
  `loylty_point_price_adj_amt_usd` double,
  `loylty_point_price_adj_amt_local` double,
  `emp_disc_price_adj_amt_usd` double,
  `emp_disc_price_adj_amt_local` double,
  `itin_nbr` string,
  `frnt_end_cmsn_amt_usd` double,
  `totl_cmsn_amt_usd` double,
  `totl_genrl_bkg_price_amt_usd` double,
  `totl_genrl_bkg_price_amt_local` double,
  `totl_genrl_bkg_cost_amt_usd` double,
  `totl_genrl_bkg_cost_amt_local` double,
  `bk_tm_key` smallint,
  `trans_tm_key` smallint,
  `order_conf_nbr` string,
  `bkg_sys_of_rec_ref_code` string,
  `est_net_rev_amt_usd` double,
  `business_unit_key` smallint,
  `sales_tax_price_amt_usd` double,
  `sales_tax_price_amt_local` double,
  `margn_sales_tax_price_amt_usd` double,
  `margn_sales_tax_price_amt_local` double,
  `occup_tax_price_amt_usd` double,
  `occup_tax_price_amt_local` double,
  `margn_occup_tax_price_amt_usd` double,
  `margn_occup_tax_price_amt_local` double,
  `othr_tax_price_amt_usd` double,
  `othr_tax_price_amt_local` double,
  `sales_tax_cost_amt_usd` double,
  `sales_tax_cost_amt_local` double,
  `margn_sales_tax_cost_amt_usd` double,
  `margn_sales_tax_cost_amt_local` double,
  `occup_tax_cost_amt_usd` double,
  `occup_tax_cost_amt_local` double,
  `margn_occup_tax_cost_amt_usd` double,
  `margn_occup_tax_cost_amt_local` double,
  `othr_tax_cost_amt_usd` double,
  `othr_tax_cost_amt_local` double,
  `est_cost_of_sale_amt_usd` double,
  `est_gross_profit_amt_usd` double,
  `est_var_cost_of_sale_amt_usd` double,
  `est_var_gross_profit_amt_usd` double,
  `gl_product_key` smallint,
  `mktg_code_key` int,
  `order_id` bigint,
  `order_src_sys_id` smallint,
  `order_ln_seq_nbr` smallint,
  `bk_agnt_key` int,
  `gmt_bk_date_key` date,
  `gmt_bk_tm_key` smallint,
  `itin_bk_agnt_key` int,
  `itin_bk_trvl_acct_key` int,
  `itin_create_datetm` string,
  `pst_itin_create_date_key` date,
  `gmt_itin_create_date_key` date,
  `pst_itin_create_tm_key` smallint,
  `gmt_itin_create_tm_key` smallint,
  `itin_online_offln_ind_key` smallint,
  `orignl_bk_agnt_key` int,
  `orignl_itin_bk_agnt_key` int,
  `orignl_trans_agnt_key` int,
  `trans_agnt_key` int,
  `pst_trans_date_key` date,
  `gmt_trans_date_key` date,
  `pst_trans_tm_key` smallint,
  `gmt_trans_tm_key` smallint,
  `trvl_duratn_key` smallint,
  `src_tm_zone_key` smallint,
  `suppl_recon_price_adj_amt_usd` double,
  `suppl_recon_price_adj_amt_local` double,
  `suppl_recon_price_adj_amt_tpid` double,
  `suppl_recon_cost_adj_amt_usd` double,
  `suppl_recon_cost_adj_amt_local` double,
  `suppl_recon_cost_adj_amt_tpid` double,
  `hist_lodg_rate_rule_key` int,
  `business_partnr_templt_key` smallint,
  `business_partnr_specific_bkg_info_key` bigint,
  `dom_intl_bkg_itm_ind_key` smallint,
  `lgl_entity_key` smallint,
  `mgmt_unit_key` smallint,
  `oracle_gl_product_key` smallint,
  `suppl_bkg_conf_code` string,
  `order_nbr` bigint,
  `distr_key` smallint,
  `property_local_bk_date_key` date,
  `property_local_bk_tm_key` smallint,
  `price_struct_key` smallint,
  `stndal_htl_price_mod_amt_usd` double,
  `stndal_htl_price_mod_amt_local` double,
  `stndal_htl_price_mod_amt_tpid` double,
  `bkg_refrl_src_key` smallint,
  `mod_reasn_key` smallint,
  `base_price_amt_cost_currn` double,
  `dyn_rate_rule_price_amt_cost_currn` double,
  `gross_bkg_amt_cost_currn` double,
  `frnt_end_cmsn_amt_cost_currn` double,
  `bkg_comp_amt_usd` double,
  `pure_bkg_comp_amt_usd` double,
  `refundable_ind_key` smallint,
  `pos_key` smallint,
  `deposit_ind_key` smallint,
  `deposit_amt_usd` double,
  `deposit_amt_local` double,
  `deposit_amt_tpid` double,
  `deposit_pct` float,
  `stndal_cmprbl_ref_cost_usd` double,
  `stndal_cmprbl_ref_cost_local` double,
  `stndal_cmprbl_ref_cost_tpid` double,
  `stndal_cmprbl_ref_price_usd` double,
  `stndal_cmprbl_ref_price_local` double,
  `stndal_cmprbl_ref_price_tpid` double,
  `order_ln_guid` string,
  `trans_cookie_guid` string,
  `call_id` string,
  `cust_ops_call_src_sys_key` smallint,
  `pos_order_ref_nbr` string,
  `trans_user_ip_addr` string,
  `stndal_lodg_ref_ind_key` smallint,
  `multi_itm_price_ind_key` smallint,
  `trans_process_typ_key` smallint,
  `mixed_rate_pln_ind_key` smallint,
  `base_frnt_end_cmsn_amt_usd` double,
  `base_frnt_end_cmsn_amt_cost_currn` double,
  `var_frnt_end_cmsn_amt_usd` double,
  `var_frnt_end_cmsn_amt_cost_currn` double,
  `trvl_svc_provdr_key` smallint,
  `bk_order_src_key` int,
  `lodg_bkg_ind_key` smallint,
  `contracted_base_price_amt_local` double,
  `contracted_base_price_amt_usd` double,
  `contracted_base_cost_amt_local` double,
  `contracted_base_cost_amt_usd` double,
  `etl_create_datetm` timestamp,
  `etl_update_datetm` timestamp,
  `etl_create_process_run_id` int,
  `etl_update_process_run_id` int,
  `eca_base_cost_amt_usd` double,
  `eca_base_cost_amt_local` double,
  `eca_base_cost_amt_tpid` double,
  `eca_cost_adj_amt_usd` double,
  `eca_cost_adj_amt_local` double,
  `eca_cost_adj_amt_tpid` double,
  `eca_fee_cost_amt_usd` double,
  `eca_fee_cost_amt_local` double,
  `eca_fee_cost_amt_tpid` double,
  `var_margn_credt_usd` double,
  `var_margn_credt_local` double,
  `var_margn_credt_tpid` double)
PARTITIONED BY (
  `trans_month` string)
ROW FORMAT SERDE
  'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'
STORED AS INPUTFORMAT
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'
OUTPUTFORMAT
  'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
LOCATION
  's3://daps-cdfs-compliance-data/{git-branch-name}/lodg_rm_night_trans_fact_functional_test'
